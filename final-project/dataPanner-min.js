<<<<<<< HEAD
function getData(){source=audioCtx.createBufferSource(),request=new XMLHttpRequest,console.log("FILEINDEX: "+fileIndex);var e=Math.ceil(5*Math.random())+fileSubset[fileIndex];fileIndex++,fileIndex>3&&(fileIndex=0),console.log("sounds/crash"+e+".mp3"),request.open("GET","sounds/crash"+e+".mp3",!0),request.responseType="arraybuffer",request.onload=function(){audioCtx.decodeAudioData(request.response,function(e){source.buffer=e,source.connect(audioCtx.destination)},function(e){console.log("Error connecting to audio file"+e.err)})},request.send()}var audioCtx=new(window.AudioContext||window.webkitAudioContext),myAudio=document.querySelector("audio"),pre=document.querySelector("pre"),myScript=document.querySelector("script"),colors=["#222","#555","#666","#777","#888","#999","#AAA","#BBB","#CCC","#DDD","#EEE","#f2f2f2"];pre.innerHTML=myScript.innerHTML;var source,fileSubset=[0,5,10,15],fileIndex=0,panNode=audioCtx.createStereoPanner(),gainNode=audioCtx.createGain(),compressor=audioCtx.createDynamicsCompressor();compressor.threshold.value=-50,compressor.knee.value=40,compressor.ratio.value=3,compressor.reduction.value=-20,compressor.attack.value=0,compressor.release.value=.25;var myLoc=[40.7128,74.0059],eastWestScale=d3.scaleLinear().range([-1,1]).domain([-.2,.2]).clamp(!0),northSouthScale=d3.scaleLinear().range([0,1]).domain([-.2,.2]).clamp(!0);d3.csv("data/nyc-mvc-oneDayMarch.csv",function(e){function o(){r=!1}function t(){r=!0,d3.select("#entrance").style("display","none"),a()}function n(){c=!c,console.log("NORTH: "+c),c?d3.select("div#north").style("color","#f2f2f2").style("background","#222").text("NORTH"):d3.select("div#north").style("color","#222").style("background","#f2f2f2").text("SOUTH")}function a(){setTimeout(function(){var o="am",t=Math.floor(i/60);t>=12&&(t%=12,o="pm"),t<10&&(t="0"+t),t<1&&(t=12);var n=i%60;if(n<10&&(n="0"+n),s.html(t+":"+n+'<span id="ampm">'+o+"</span>"),i==e[d].TIME){var a=0,l;console.log(e[d].TIME),l=parseFloat(e[d].TIME),lat=e[d].LATITUDE,lng=e[d].LONGITUDE,diffX=parseFloat(lng)+parseFloat(myLoc[1]),diffY=parseFloat(lat)-parseFloat(myLoc[0]),dist=Math.sqrt(Math.pow(diffX,2)+Math.pow(diffY,2)),console.log("DIFFX: "+diffX),console.log("DIFFY: "+diffY),console.log("DIST: "+dist);var f=200*i+125*d;console.log("TIME TOTAL: "+f);var p=10,m=1/(100*dist);northVol=10*northSouthScale(diffY)*m,southVol=10*(1-northVol)*m,isNaN(diffX)||(console.log("northVol: "+northVol),panNode.pan.value=eastWestScale(diffX),console.log("PAN: "+eastWestScale(diffX)),gainNode.gain.value=c?northVol:southVol,getData(),source.connect(gainNode),gainNode.connect(compressor),compressor.connect(panNode),panNode.connect(audioCtx.destination),source.start(0)),a++,d++}d<e.length&&(i==e[d].TIME?(u=75,console.log("SIMULTANEOUS")):(u=175,i++)),i<1440&&r&&(simCount=0)},u)}console.log(e);var r=!1;a(),d3.selectAll(".play").on("click",t),d3.selectAll(".pause").on("click",o),d3.select("div#north").on("click",n);var c=!1,s=d3.select("h1#clock"),l=d3.select("span#date"),i=0,d=0,u=100;l.text(" "+e[d].DATE)});
=======
function getData(){source=audioCtx.createBufferSource(),request=new XMLHttpRequest,console.log("FILEINDEX: "+fileIndex);var e=Math.ceil(5*Math.random())+fileSubset[fileIndex];fileIndex++,fileIndex>3&&(fileIndex=0),console.log("sounds/crash"+e+".mp3"),request.open("GET","sounds/crash"+e+".mp3",!0),request.responseType="arraybuffer",request.onload=function(){audioCtx.decodeAudioData(request.response,function(e){source.buffer=e,source.connect(audioCtx.destination)},function(e){console.log("Error connecting to audio file"+e.err)})},request.send()}var audioCtx=new(window.AudioContext||window.webkitAudioContext),myAudio=document.querySelector("audio"),pre=document.querySelector("pre"),myScript=document.querySelector("script");pre.innerHTML=myScript.innerHTML;var source,fileSubset=[0,5,10,15],fileIndex=0,panNode=audioCtx.createStereoPanner(),gainNode=audioCtx.createGain(),compressor=audioCtx.createDynamicsCompressor();compressor.threshold.value=-50,compressor.knee.value=40,compressor.ratio.value=3,compressor.reduction.value=-20,compressor.attack.value=0,compressor.release.value=.25;var myLoc=[40.7128,74.0059],eastWestScale=d3.scaleLinear().range([-1,1]).domain([-.2,.2]).clamp(!0),northSouthScale=d3.scaleLinear().range([0,1]).domain([-.2,.2]).clamp(!0);d3.csv("data/nyc-mvc-oneDayMarch.csv",function(e){function o(){r=!1}function t(){r=!0,a()}function n(){c=!c,console.log("NORTH: "+c)}function a(){setTimeout(function(){var o="am",t=Math.floor(i/60);t>=12&&(t%=12,o="pm"),t<10&&(t="0"+t),t<1&&(t=12);var n=i%60;if(n<10&&(n="0"+n),s.html(t+":"+n+'<span id="ampm">'+o+"</span>"),i==e[d].TIME){var l=0,f;console.log(e[d].TIME),f=parseFloat(e[d].TIME),lat=e[d].LATITUDE,lng=e[d].LONGITUDE,diffX=parseFloat(lng)+parseFloat(myLoc[1]),diffY=parseFloat(lat)-parseFloat(myLoc[0]),dist=Math.sqrt(Math.pow(diffX,2)+Math.pow(diffY,2)),console.log("DIFFX: "+diffX),console.log("DIFFY: "+diffY),console.log("DIST: "+dist);var p=200*i+125*d;console.log("TIME TOTAL: "+p);var m=10,g=1/(100*dist);northVol=10*northSouthScale(diffY)*g,southVol=10*(1-northVol)*g,isNaN(diffX)||(console.log("northVol: "+northVol),panNode.pan.value=eastWestScale(diffX),console.log("PAN: "+eastWestScale(diffX)),gainNode.gain.value=c?northVol:southVol,getData(),source.connect(gainNode),gainNode.connect(compressor),compressor.connect(panNode),panNode.connect(audioCtx.destination),source.start(0)),l++,d++}d<e.length&&(i==e[d].TIME?(u=125,console.log("SIMULTANEOUS")):(u=200,i++)),i<1440&&r&&a()},u)}console.log(e);var r=!0;a(),d3.select("div#play").on("click",t),d3.select("div#pause").on("click",o),d3.select("div#north").on("click",n);var c=!1,s=d3.select("h1#clock"),l=d3.select("span#date"),i=0,d=0,u=100;l.text(" "+e[d].DATE)});
>>>>>>> parent of 700a6de... added better play/pause, more functionality
