function getData(){source=audioCtx.createBufferSource(),request=new XMLHttpRequest,n=Math.ceil(6*Math.random()),console.log("sounds/crash"+n+".mp3"),request.open("GET","sounds/crash"+n+".mp3",!0),request.responseType="arraybuffer",request.onload=function(){audioCtx.decodeAudioData(request.response,function(e){source.buffer=e,source.connect(audioCtx.destination)},function(e){console.log("Error connecting to audio file"+e.err)})},request.send()}var audioCtx=new(window.AudioContext||window.webkitAudioContext),myAudio=document.querySelector("audio"),pre=document.querySelector("pre"),myScript=document.querySelector("script");pre.innerHTML=myScript.innerHTML;var source,panNode=audioCtx.createStereoPanner(),gainNode=audioCtx.createGain(),myLoc=[40.7128,74.0059],eastWestScale=d3.scaleLinear().range([-1,1]).domain([-.2,.2]).clamp(!0),northSouthScale=d3.scaleLinear().range([0,1]).domain([-.2,.2]).clamp(!0);d3.csv("data/nyc-mvc-oneDayMarch.csv",function(e){function o(){t=!1}function n(){t=!0,a()}function a(){setTimeout(function(){var o="am",n=Math.floor(s/60);n>=12&&(n%=12,o="pm"),n<10&&(n="0"+n),n<1&&(n=12);var i=s%60;if(i<10&&(i="0"+i),r.html(n+":"+i+'<span id="ampm">'+o+"</span>"),s==e[d].TIME){var l=0,p;console.log(e[d].TIME),p=parseFloat(e[d].TIME),lat=e[d].LATITUDE,lng=e[d].LONGITUDE,diffX=parseFloat(lng)+parseFloat(myLoc[1]),diffY=parseFloat(lat)-parseFloat(myLoc[0]);var f=20,m=20*northSouthScale(diffY),g=20*(1-m);isNaN(diffX)||(console.log("northVol: "+m),panNode.pan.value=eastWestScale(diffX),gainNode.gain.value=c?m:g,getData(),source.connect(panNode),panNode.connect(gainNode),gainNode.connect(audioCtx.destination),source.start(0)),l++,d++}d<e.length&&(s==e[d].TIME?u=20:(u=120,s++)),s<1440&&t&&a()},u)}console.log(e);var t=!1;d3.select("div#play").on("click",n),d3.select("div#pause").on("click",o);var c=!1,r=d3.select("h1#clock"),i=d3.select("span#date"),s=0,d=0,u=100;i.text(" "+e[d].DATE)});