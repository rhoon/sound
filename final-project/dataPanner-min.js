function getData(){source=audioCtx.createBufferSource(),request=new XMLHttpRequest,n=Math.ceil(20*Math.random()),console.log("sounds/crash"+n+".mp3"),request.open("GET","sounds/crash"+n+".mp3",!0),request.responseType="arraybuffer",request.onload=function(){audioCtx.decodeAudioData(request.response,function(o){source.buffer=o,source.connect(audioCtx.destination)},function(o){console.log("Error connecting to audio file"+o.err)})},request.send()}var audioCtx=new(window.AudioContext||window.webkitAudioContext),myAudio=document.querySelector("audio"),pre=document.querySelector("pre"),myScript=document.querySelector("script");pre.innerHTML=myScript.innerHTML;var source,panNode=audioCtx.createStereoPanner(),gainNode=audioCtx.createGain(),myLoc=[40.7128,74.0059],eastWestScale=d3.scaleLinear().range([-1,1]).domain([-.2,.2]).clamp(!0),northSouthScale=d3.scaleLinear().range([0,1]).domain([-.2,.2]).clamp(!0);d3.csv("data/nyc-mvc-oneDayMarch.csv",function(o){function e(){c=!1}function n(){c=!0,a()}function t(){r=!r,console.log("NORTH: "+r)}function a(){setTimeout(function(){var e="am",n=Math.floor(l/60);n>=12&&(n%=12,e="pm"),n<10&&(n="0"+n),n<1&&(n=12);var t=l%60;if(t<10&&(t="0"+t),i.html(n+":"+t+'<span id="ampm">'+e+"</span>"),l==o[d].TIME){var s=0,f;console.log(o[d].TIME),f=parseFloat(o[d].TIME),lat=o[d].LATITUDE,lng=o[d].LONGITUDE,diffX=parseFloat(lng)+parseFloat(myLoc[1]),diffY=parseFloat(lat)-parseFloat(myLoc[0]),dist=Math.sqrt(Math.pow(diffX,2)+Math.pow(diffY,2)),console.log("DIFFX: "+diffX),console.log("DIFFY: "+diffY),console.log("DIST: "+dist);var p=200*l+125*d;console.log("TIME TOTAL: "+p);var g=10,h=1/(100*dist);northVol=10*northSouthScale(diffY)*h,southVol=10*(1-northVol)*h,isNaN(diffX)||(console.log("northVol: "+northVol),panNode.pan.value=eastWestScale(diffX),gainNode.gain.value=r?northVol:southVol,getData(),source.connect(panNode),panNode.connect(gainNode),gainNode.connect(audioCtx.destination),source.start(0)),s++,d++}d<o.length&&(l==o[d].TIME?(u=125,console.log("SIMULTANEOUS")):(u=200,l++)),l<1440&&c&&a()},u)}console.log(o);var c=!1;d3.select("div#play").on("click",n),d3.select("div#pause").on("click",e),d3.select("div#north").on("click",t);var r=!1,i=d3.select("h1#clock"),s=d3.select("span#date"),l=0,d=0,u=100;s.text(" "+o[d].DATE)});